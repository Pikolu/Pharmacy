<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/template">
<head>
    <title th:text="${pharmacy.displayName}"></title>
</head>
<body>
<div th:fragment="content">
    <div id="notification"></div>
    <div id="content">
        <h1>Apotheke: <span th:text="${pharmacy.displayName}"></span></h1>
        <div class="box">
            <div class="box-heading">Anschrift</div>
            <div class="box-content">
                <div class="box-product">
                    <div style="padding: 10px 10px 10px 18px">
                        <h3 style="margin: 0px;" th:text="${pharmacy.name}"></h3>
                        <span th:text="${pharmacy.owner}">Name</span>
                        <br/>
                        <span th:text="${pharmacy.street}">Street</span>
                        <span th:text="${pharmacy.houseNumber}"></span>
                        <br/>
                        <span th:text="${pharmacy.ZipCode}">POST Code</span>
                        <span th:text="${pharmacy.city}">City</span>
                        <br/><br/>
                        <span>Telefon: <span th:text="${pharmacy.phoneNumber}"></span></span>
                        <br/>
                        <span>Telefax: <span th:text="${pharmacy.fax}"></span></span>
                        <br/>
                        <span>E-Mail: <a th:href="'mailto:' + ${pharmacy.email}" th:text="${pharmacy.email}">E-Mail</a></span>
                        <br/>
                        <span>Internet: <a th:href="${pharmacy.homePage}" th:text="${pharmacy.homePage}"
                                           target="_blank"></a></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="box">
        <div class="box-heading">Zahlungsarten / Versand</div>
        <div class="box-content">
            <div class="box-product">
                <div style="padding: 10px 10px 10px 18px">
                    <div>
                        <h2>Zahlungsarten</h2>
                        <hr/>
                        <div th:each="payment : ${pharmacy.payments}">
                            <div style="margin: 5px 0 5px 0;">
                                <img th:src="@{/images/payment/} + ${payment.name} + '.png' " th:alt="${payment.name}"/>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 10px">
                        <h2>Versandkosten</h2>
                        <hr/>
                        Portofrei ab <span
                            th:text="${#numbers.formatDecimal(pharmacy.freeShipping, 0, 'COMMA', 2, 'POINT')}"/> €.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="box">
        <div class="box-heading">Bewertungen</div>
        <div class="box-content box-evaluation">
            <div th:if="${evaluations.isEmpty()}"
                 style="border-bottom: 1px solid #E5E5E5; padding: 5px 0px 5px 10px;">
                Zurzeit gibt es keine Bewertungen.
            </div>
            <div th:each="evaluation : ${evaluations}" class="evaluation-box"
                 style="height: 60px; border-bottom: 1px solid #E5E5E5; padding: 5px 0px 5px 10px;">
                <span style="float: left"
                      th:text="${T(com.pharmacy.web.helper.DateTimeConverter).convert(evaluation.creationDate)}"></span>
                <span style="float: left">&nbsp; | &nbsp;</span>

                <div th:id="${'current_evaluation_' + evaluation.id}"></div>

                <h2 class="ellipsis" th:text="${evaluation.name}"></h2>

                <div class="ellipsis" th:text="${evaluation.description}"></div>

                <script th:inline="javascript">/*<![CDATA[*/
                var prefix = [[${evaluation.id}]];
                var id = '#current_evaluation_' + prefix;
                jQuery(id).raty({
                    readOnly: true,
                    start: [[${evaluation.points}]],
                    path: [[@{/images/raiting/}]]});

                /*]]>*/

                </script>
            </div>
        </div>
    </div>

    <div class="box">
        <div class="box-heading">Produkte</div>
        <div class="box-content">
            <table border="0" cellpadding="5" cellspacing="0" style="width: 100%"
                   th:if="${!products.isEmpty()}">
                <tr th:each="article : ${products}">
                    <td style="border-bottom: 1px solid #E5E5E5">
                        <table style="width: 100%">
                            <tr>
                                <td style="width: 100px">
                                    <div style="float: left; width: 100px; height: 100px">
                                        <img th:if="${#strings.isEmpty(article.imageURL)}" th:alt="${article.name}" th:src="@{/images/no-pic.jpg}"
                                             width="100"
                                             height="100"/>
                                        <img th:if="${!#strings.isEmpty(article.imageURL)}" th:alt="${article.name}" th:src="${article.imageURL}"
                                             width="100"
                                             height="100"/>
                                    </div>
                                </td>
                                <td style="vertical-align: baseline;">
                                    <div style="margin-left: 25px; float: left;">
                                        <h4 style="margin: 0px;">
                                            <a th:href="@{/preisvergleich/} + ${article.id} + '/' + ${urlEncoder.encodeURL(article.name)}"
                                               th:text="${article.name}">Name</a>
                                        </h4>
                                        <br/>
                                    </div>
                                </td>
                                <td style="width: 130px; vertical-align: baseline;"
                                    th:with="bestPrice=${articleHelper.getBestDiscount(article.prices)}">
                                    <div>ab <span th:text="${#numbers.formatDecimal(bestPrice.get().price, 1, 2)}"></span> €</div>
                                    <div th:if="${bestPrice.get().discount > 0}" style="color: #D14F4F">
                                        <span th:text="${bestPrice.get().discount}">discount</span>
                                        %
                                        <span> Ersparnis</span>
                                    </div>
                                </td>
                                <td style="width: 155px; text-align: right; padding-right: 20px;">
                                    <a class="buttonlight morebutton"
                                       th:href="@{/preisvergleich/} + ${article.id} + '/' + ${urlEncoder.encodeURL(article.name)}">Zum
                                        Preisvergleich</a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <table border="0" cellpadding="5" cellspacing="5" style="margin: auto;"
                   th:if="${!searchResult.searchPage.getContent().isEmpty()}">
                <tr>
                    <td>
                        <a th:href="@{/apotheke/{id}/{name}(id=${pharmacy.id},name=${pharmacy.displayName}, page=${currentPage - 1})}"
                           style="float: right;" th:if="${currentPage > 1}">Zurück</a>
                    </td>
                    <td style="width: 10px;" th:each="i : ${#numbers.sequence(firstPage, lastPage)}">
                        <span th:if="${currentPage eq i}" th:text="${i}"></span>
                        <a th:href="@{/apotheke/{id}/{name}(id=${pharmacy.id},name=${pharmacy.displayName}, page=${i})}"
                           th:if="${currentPage != i}" th:text="${i}"></a>
                    </td>
                    <td>
                        <a th:href="@{/apotheke/{id}/{name}(id=${pharmacy.id},name=${pharmacy.displayName}, page=${currentPage + 1})}"
                           th:if="${currentPage lt lastPage}">Weiter</a>
                    </td>
                </tr>
            </table>

        </div>
    </div>
</div>
</body>
</html>